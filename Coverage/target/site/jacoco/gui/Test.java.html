<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>Test.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">project</a> &gt; <a href="index.source.html" class="el_package">gui</a> &gt; <span class="el_source">Test.java</span></div><h1>Test.java</h1><pre class="source lang-java linenums">package gui;

import java.awt.Color;
import java.awt.Component;
import java.awt.EventQueue;
import java.awt.GridBagConstraints;
import java.awt.GridBagLayout;
import java.awt.GridLayout;
import java.awt.datatransfer.DataFlavor;
import java.awt.datatransfer.StringSelection;
import java.awt.datatransfer.Transferable;
import java.awt.dnd.DnDConstants;
import java.awt.event.MouseAdapter;
import java.awt.event.MouseEvent;
import javax.swing.JButton;
import javax.swing.JComponent;
import javax.swing.JFrame;
import javax.swing.JLabel;
import javax.swing.JPanel;
import javax.swing.TransferHandler;
import javax.swing.UIManager;
import javax.swing.UnsupportedLookAndFeelException;
import javax.swing.border.CompoundBorder;
import javax.swing.border.EmptyBorder;
import javax.swing.border.LineBorder;

public class Test {

    public static void main(String[] args) {
<span class="nc" id="L30">        new Test();</span>
<span class="nc" id="L31">    }</span>

<span class="nc" id="L33">    public Test() {</span>
<span class="nc" id="L34">        EventQueue.invokeLater(new Runnable() {</span>
            @Override
            public void run() {
                try {
<span class="nc" id="L38">                    UIManager.setLookAndFeel(UIManager.getSystemLookAndFeelClassName());</span>
<span class="nc" id="L39">                } catch (ClassNotFoundException | InstantiationException | IllegalAccessException | UnsupportedLookAndFeelException ex) {</span>
<span class="nc" id="L40">                    ex.printStackTrace();</span>
<span class="nc" id="L41">                }</span>

<span class="nc" id="L43">                JFrame frame = new JFrame(&quot;Testing&quot;);</span>
<span class="nc" id="L44">                frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);</span>
<span class="nc" id="L45">                frame.add(new TestPane());</span>
<span class="nc" id="L46">                frame.pack();</span>
<span class="nc" id="L47">                frame.setLocationRelativeTo(null);</span>
<span class="nc" id="L48">                frame.setVisible(true);</span>
<span class="nc" id="L49">            }</span>
        });
<span class="nc" id="L51">    }</span>

    public class TestPane extends JPanel {

<span class="nc" id="L55">        public TestPane() {</span>
<span class="nc" id="L56">            setLayout(new GridLayout(1, 2));</span>
<span class="nc" id="L57">            add(createLeftPanel());</span>
<span class="nc" id="L58">            add(createRightPanel());</span>

<span class="nc" id="L60">        }</span>

        protected JPanel createLeftPanel() {
<span class="nc" id="L63">            JPanel panel = new JPanel(new GridBagLayout());</span>
<span class="nc" id="L64">            GridBagConstraints gbc = new GridBagConstraints();</span>
<span class="nc" id="L65">            gbc.gridwidth = GridBagConstraints.REMAINDER;</span>
<span class="nc" id="L66">            gbc.fill = GridBagConstraints.HORIZONTAL;</span>
<span class="nc" id="L67">            gbc.weightx = 1;</span>
<span class="nc bnc" id="L68" title="All 2 branches missed.">            for (int index = 0; index &lt; 10; index++) {</span>
<span class="nc" id="L69">                JButton btn = new JButton(Integer.toString(index + 1));</span>
<span class="nc" id="L70">                panel.add(btn, gbc);</span>
<span class="nc" id="L71">                btn.setTransferHandler(new ValueExportTransferHandler(Integer.toString(index + 1)));</span>

<span class="nc" id="L73">                btn.addMouseMotionListener(new MouseAdapter() {</span>
                    @Override
                    public void mouseDragged(MouseEvent e) {
<span class="nc" id="L76">                        JButton button = (JButton) e.getSource();</span>
<span class="nc" id="L77">                        TransferHandler handle = button.getTransferHandler();</span>
<span class="nc" id="L78">                        handle.exportAsDrag(button, e, TransferHandler.COPY);</span>
<span class="nc" id="L79">                    }</span>
                });
            }
<span class="nc" id="L82">            return panel;</span>
        }

        protected JPanel createRightPanel() {
<span class="nc" id="L86">            JPanel panel = new JPanel(new GridBagLayout());</span>
<span class="nc" id="L87">            JLabel label = new JLabel(&quot;Drop in&quot;);</span>
<span class="nc" id="L88">            label.setBorder(new CompoundBorder(new LineBorder(Color.DARK_GRAY), new EmptyBorder(20, 20, 20, 20)));</span>
<span class="nc" id="L89">            label.setTransferHandler(new ValueImportTransferHandler());</span>
<span class="nc" id="L90">            panel.add(label);</span>
<span class="nc" id="L91">            return panel;</span>
        }

    }

    public static class ValueExportTransferHandler extends TransferHandler {

<span class="nc" id="L98">        public static final DataFlavor SUPPORTED_DATE_FLAVOR = DataFlavor.stringFlavor;</span>
        private String value;

<span class="nc" id="L101">        public ValueExportTransferHandler(String value) {</span>
<span class="nc" id="L102">            this.value = value;</span>
<span class="nc" id="L103">        }</span>

        public String getValue() {
<span class="nc" id="L106">            return value;</span>
        }

        @Override
        public int getSourceActions(JComponent c) {
<span class="nc" id="L111">            return DnDConstants.ACTION_COPY_OR_MOVE;</span>
        }

        @Override
        protected Transferable createTransferable(JComponent c) {
<span class="nc" id="L116">            Transferable t = new StringSelection(getValue());</span>
<span class="nc" id="L117">            return t;</span>
        }

        @Override
        protected void exportDone(JComponent source, Transferable data, int action) {
<span class="nc" id="L122">            super.exportDone(source, data, action);</span>
            // Decide what to do after the drop has been accepted
<span class="nc" id="L124">        }</span>

    }

    public static class ValueImportTransferHandler extends TransferHandler {

<span class="nc" id="L130">        public static final DataFlavor SUPPORTED_DATE_FLAVOR = DataFlavor.stringFlavor;</span>

<span class="nc" id="L132">        public ValueImportTransferHandler() {</span>
<span class="nc" id="L133">        }</span>

        @Override
        public boolean canImport(TransferHandler.TransferSupport support) {
<span class="nc" id="L137">            return support.isDataFlavorSupported(SUPPORTED_DATE_FLAVOR);</span>
        }

        @Override
        public boolean importData(TransferHandler.TransferSupport support) {
<span class="nc" id="L142">            boolean accept = false;</span>
<span class="nc bnc" id="L143" title="All 2 branches missed.">            if (canImport(support)) {</span>
                try {
<span class="nc" id="L145">                    Transferable t = support.getTransferable();</span>
<span class="nc" id="L146">                    Object value = t.getTransferData(SUPPORTED_DATE_FLAVOR);</span>
<span class="nc bnc" id="L147" title="All 2 branches missed.">                    if (value instanceof String) {</span>
<span class="nc" id="L148">                        Component component = support.getComponent();</span>
<span class="nc bnc" id="L149" title="All 2 branches missed.">                        if (component instanceof JLabel) {</span>
<span class="nc" id="L150">                            ((JLabel) component).setText(value.toString());</span>
<span class="nc" id="L151">                            accept = true;</span>
                        }
                    }
<span class="nc" id="L154">                } catch (Exception exp) {</span>
<span class="nc" id="L155">                    exp.printStackTrace();</span>
<span class="nc" id="L156">                }</span>
            }
<span class="nc" id="L158">            return accept;</span>
        }
    }
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.6.202009150832</span></div></body></html>